<!DOCTYPE html>
<html>
	<head>
		<title>Space Tribute</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script src="jsfxr.js"></script>
		<style type="text/css">
			html, body {
				height:100%;
			}
			body {
				background-color:#000;
				margin:0;
			}
			canvas {
				max-width:100%;
				max-height:100%;
				margin:0 auto;
				display:block;
			}
			</style>
		<script>
	
			var g,canvas,ctx,player,rad=[],bonusList=[],imgs=[];bonusList[1]={letter:"X",name:"explosion"},bonusList[2]={letter:"P",name:"armor"},bonusList[3]={letter:"T",name:"armor"},EXPLOSION=function($,_,t,e,o){this.x=$,this.y=_,this.color=t,this.size=e,this.opacity=1,this.pixels=[],this.gravity=o||0;for(var $=0;$<34;$+=3)for(var _=0;_<24;_+=3){var r={};r.x=this.x+$,r.y=this.y+_,r.tx=($-17)*(Math.random()-.5),r.ty=(_-10)*(Math.random()-.5),r.r=Math.floor(256*Math.random()),r.g=Math.floor(256*Math.random()),r.b=Math.floor(256*Math.random()),this.pixels.push(r)}this.update=function(){if(this.opacity-=.01,this.opacity<=0)return!1;ctx.fillStyle="rgba("+this.color[0]+","+this.color[1]+","+this.color[2]+","+this.opacity+")";for(var $=0;$<this.pixels.length;$++){var _=this.pixels[$];ctx.fillStyle="rgba("+Math.floor(255-255*(1-this.opacity))+","+Math.floor(255-255*(1-this.opacity))+",255,"+this.opacity+")",_.ty+=this.gravity,_.x+=_.tx,_.y+=_.ty,ctx.fillRect(_.x,_.y,2*this.size,2*this.size)}return!0}},WEAPON_LASERPLAYER=function(){this.width=20,this.height=4,this.speed=40,this.fromPlayer=!0,this.draw=function(){ctx.beginPath(),ctx.lineWidth=4,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#00F",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON_FIREBALLPLAYER=function(){this.width=20,this.height=4,this.speed=40,this.fromPlayer=!0,this.draw=function(){ctx.beginPath(),ctx.arc(this.x+20,this.y,5,0,2*Math.PI,!1),ctx.fillStyle="#ED5615",ctx.fill()},WEAPON.apply(this,arguments)},WEAPON_LASER=function(){this.width=20,this.height=4,this.speed=10,this.aimToPlayer=!0,this.draw=function(){ctx.fillStyle="#F00",ctx.beginPath(),ctx.lineWidth=4,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#F00",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON_FIREBALL=function(){this.width=5,this.height=5,this.speed=15,this.aimToPlayer=!0,this.draw=function(){ctx.beginPath(),ctx.arc(this.x+20,this.y,5,0,2*Math.PI,!1),ctx.fillStyle="#EB1DEB",ctx.fill()},WEAPON.apply(this,arguments)},WEAPON_NUNCHUNK=function(){this.width=20,this.height=4,this.speed=15,this.aimToPlayer=!1,this.round=0,this.draw=function(){this.round-=.1,ctx.fillStyle="#FFF",ctx.beginPath(),ctx.lineWidth=4,ctx.moveTo(this.x+-(Math.sin(this.round)*this.width),this.y- -(Math.cos(this.round)*this.width)),ctx.lineTo(this.x+Math.sin(this.round)*this.width,this.y-Math.cos(this.round)*this.width),ctx.strokeStyle="#FFF",ctx.stroke(),ctx.beginPath(),ctx.arc(this.x+-(Math.sin(this.round)*this.width),this.y- -(Math.cos(this.round)*this.width),5,0,2*Math.PI,!1),ctx.fillStyle="#EEE",ctx.fill(),ctx.beginPath(),ctx.arc(this.x+Math.sin(this.round)*this.width,this.y-Math.cos(this.round)*this.width,5,0,2*Math.PI,!1),ctx.fillStyle="#EEE",ctx.fill()},WEAPON.apply(this,arguments)},WEAPON_HARPOON=function(){this.width=20,this.height=10,this.speed=30,this.aimToPlayer=!0,this.draw=function(){this.round-=.1,ctx.fillStyle="#FFF",ctx.beginPath(),ctx.lineWidth=10,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#FFF",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON_BOSS=function(){this.width=20,this.height=4,this.speed=20,this.aimToPlayer=!1,this.homing=!0,this.draw=function(){ctx.fillStyle="#FF4F00",ctx.beginPath(),ctx.lineWidth=12,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#FF4F00",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON=function($,_,t,e){this.x=$,this.y=_,this.type=e,this.angle=t,this.update=function(){if(this.homing){var $=bearing(GAME.player.x+50,GAME.player.y+30,this.x,this.y);this.angle>$?this.angle-$>.03&&($=this.angle-.02):this.angle<$&&$-this.angle>.02&&($=this.angle+.02),this.angle=$}if(this.x+=Math.sin(this.angle)*this.speed*GAME.speed,this.y-=Math.cos(this.angle)*this.speed*GAME.speed,this.x<-50||this.x>2e3)return!1;if(this.fromPlayer)for(var _=0;_<GAME.monsters.length;_++){var t=GAME.monsters[_];if(this.x>t.x&&this.x<t.x+t.trueWidth&&this.y>t.y&&this.y<t.y+t.trueHeight)return t.life--,t.life<=0?t.explode():(sound([3,,.1379,.4076,.35,.1342,,-.3958,,,,,,,,,.535,-.2877,1,,,,,.5]),GAME.addExplosion(t.x+50*Math.random(),t.y+70*Math.random(),[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],1)),!1}else if(GAME.player.armor){if(100>Math.hypot(this.x-(GAME.player.x+50),this.y-(GAME.player.y+30)))return sound([0,,.0967,.4264,.2902,.458,,-.3199,,,,.5693,.6278,,,,,,1,,,,,.5]),GAME.player.touch=10,GAME.player.armor-=20,!1}else if(this.x>GAME.player.x&&this.x<GAME.player.x+100&&this.y>GAME.player.y&&this.y<GAME.player.y+60)return GAME.player.life-=10,sound([3,,.2436,.5091,.252,.0334,,.2411,,,,,,,,,,,1,,,,,.5]),!1;return this.draw(),!0},this.init=function(){this.aimToPlayer&&(this.angle=bearing(GAME.player.x+50,GAME.player.y+30,this.x,this.y)),this.angle||(this.fromPlayer?this.angle=Math.PI/2:this.angle=-Math.PI/2)},this.init()},bearing=function($,_,t,e){return Math.atan2($-t,e-_)},(monsters=[])[1]={colors:[,"#EDED2D"],sprite:"11:011000001100001000100000111111100011011101101111111111111111111111011111111100101000101010011011001",factor:8,weapon:"FIREBALL",reloadingTime:80},monsters[2]={colors:[,"#EB1DEB"],sprite:"9:000111000001111100011111110011010110111111111111111111011111110001000100010000010001000100",factor:8,weapon:"FIREBALL",reloadingTime:80},monsters[3]={colors:[,"#30EDED"],sprite:"12:000011110000001111111100011111111110111001100111111111111111011111111110001111111100000110011000001001100100000100001000",factor:8,weapon:"FIREBALL",reloadingTime:80},monsters[4]={colors:[,"#FFF"],sprite:"20:0011000000000000110001100000000000000110011000000000000001101100000000000000001111000000000000000011110000011111100000111100001101101100001111000110011001100011111001001001001001111111110100001011111111111101000010111111111001001001001001111100011001100110001111000011011011000011110000011111100000111100000000000000001111000000000000000011011000000000000001100110000000000000011000110000000000001100",factor:3,weapon:"LASER",reloadingTime:80},monsters[5]={colors:[,"#FFA000"],sprite:"14:000001111000000001111111100000111111111100011111001111101111100001111011110000001110111101100011111111011000111111111000011111111111001111111111111111111111111111111111111111111111111101110011101110001100110001",factor:4,weapon:"LASER",reloadingTime:80},monsters[6]={colors:[,"#FF0"],sprite:"12:000111110000011111111100111111111110111111111110001111111111000001111111001111111111111111111110111111111110011111111100000111110000",factor:4,weapon:"NUNCHUNK",reloadingTime:80},monsters[7]={colors:[,"#0FF"],sprite:"4:1111",factor:30,weapon:"HARPOON",reloadingTime:80},monsters[8]={colors:[,"#FF0"],sprite:"2:1111",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[9]={colors:[,"#A0F"],sprite:"3:111010",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[10]={colors:[,"#FFA500"],sprite:"2:010111",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[11]={colors:[,"#F00"],sprite:"3:110011",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[12]={colors:[,"#444","#fac81b","#F00"],sprite:"30:000000001111100000000000000000000000112222211000000000000000000001222222222101100000000000000001222222222212100000000000000012211222222222100000000000000012211222222221000000000000333012211222222210000000000000333332222222222210000000000000033333222222222210000000000000033333322222222210000000000000033001222222222100000000000000000000122222222100000000000000000000012222221000000000000011000000012222222111000000000121000001122222222222110000001221000012222222222222221111112221000012222221112222222222222210000122222112221112212222222210000122221222222211121222222100000122221222222222221222222100000122221222222222221222221000000122221222222222212222221000000012222122222222122222210000000012222122222221222222100000000001122211111112222211000000000000011222222222211100000000000000000111111111100000000000",factor:2,weapon:"FIREBALL",reloadingTime:80},monsters[13]={colors:[,"#c84c0c","#444","#F4d4b4"],sprite:"16:00000011110000000000011111100000000011111111000000011111111110000011211111221100011132111231111001113222223111101111323132311111111133313331111111111111111111110111133333311110011113233331111000003322223330000022232332233000022222333333220002222220002222200022222000222200",factor:4,weapon:"FIREBALL",reloadingTime:80},monsters[14]={colors:[,"#FF0","#4040E0","#F0D0D0","#00B0B0"],sprite:"9:000111000011111110121212121000020000000020000000234440000034344000034330000022200000022230000022203003222000003222000000022000000003300",factor:4,weapon:"FIREBALL",reloadingTime:80},monsters[15]={colors:[,"#2c2b2c","#ea9783","#FFF"],sprite:"15:001110000000000012221000000000122222100000000132332210000000113132210000000113132210000000133322100000000012222100000000001122211100000012222222211110012222222222221001222221111221000111110000110",factor:4,weapon:"FIREBALL",reloadingTime:8},monsters[16]={weapon:"BOSS",reloadingTime:80,life:40},drawSpriteToImg=function($){var _=monsters[$],t=_.sprite.split(":"),e=t[0],o=t[1],r=o.length/e,s=e*_.factor,n=r*_.factor,l=0,h=document.createElement("canvas");h.width=s,h.height=n;var d=h.getContext("2d");for(y=0;y<o.length/e;y++)for(x=0;x<e;x++)c=_.colors[o[l]],l++,d.fillStyle=c,c&&d.fillRect(x*_.factor,y*_.factor,_.factor,_.factor);imgs[$]=new Image,imgs[$].src=h.toDataURL("image/png")},PATH1={init:function($){$.round=-Math.PI,$.tx=16==$.type?-2:-8*Math.random()-1},update:function($){$.round+=.01*GAME.speed,$.x+=$.tx*GAME.speed,$.y+=Math.sin($.round)*GAME.speed}},PATH2={init:function($){$.round=-Math.PI},update:function($){$.round+=.01,$.speed=2,$.x+=Math.cos($.round)*$.speed*GAME.speed,$.y+=Math.sin($.round)*$.speed*GAME.speed,$.x-=1*GAME.speed}},PATH3={init:function($){$.round=-Math.PI,$.animStarted=!1,$.speed=2},update:function($){$.x<800&&($.animStarted=!0),$.animStarted?($.speed=8,$.round+=$.speed/200*GAME.speed,$.round>=1*Math.PI&&($.round=1*Math.PI),$.x+=Math.cos($.round)*$.speed*GAME.speed,$.y+=Math.sin($.round)*$.speed*GAME.speed,$.x-=1*GAME.speed):($.speed=8,$.x-=$.speed*GAME.speed)}},PATH4={init:function($){$.round=Math.PI,$.animStarted=!1,$.speed=2},update:function($){$.x<800&&($.animStarted=!0),$.animStarted?($.speed=8,$.round-=$.speed/200*GAME.speed,$.round<=-Math.PI&&($.round=-Math.PI),$.x+=Math.cos($.round)*$.speed*GAME.speed,$.y+=Math.sin($.round)*$.speed*GAME.speed,$.x-=1*GAME.speed):($.speed=8,$.x-=$.speed*GAME.speed)}},PATH5={init:function($){$.round=Math.PI,$.animStarted=!1,$.speed=2},update:function($){$.x<800&&($.animStarted=!0),$.animStarted?($.x-=$.speed*GAME.speed,$.y+=$.speed*GAME.speed):($.speed=8,$.x-=$.speed*GAME.speed)}},PATH6={init:function($){$.round=Math.PI,$.animStarted=!1,$.speed=2},update:function($){$.x<800&&($.animStarted=!0),$.animStarted?($.x-=$.speed*GAME.speed,$.y-=$.speed*GAME.speed):($.speed=8,$.x-=$.speed*GAME.speed)}},PATH7={init:function($){$.round=0,$.speed=2},update:function($){$.round+=.05*GAME.speed,$.x-=$.speed*GAME.speed,$.y-=5*Math.sin($.round)*GAME.speed}},MONSTER=function($,_,t,e){if(this.x=$,this.y=_,this.type=t,this.weapon=monsters[t].weapon,this.reloadingTime=monsters[t].reloadingTime,this.life=monsters[t].life?monsters[t].life:1,this.path=window["PATH"+e],monsters[t].sprite){var o=monsters[t].sprite.split(":");this.width=o[0],this.pixels=o[1],this.colors=monsters[t].colors,this.height=this.pixels.length/this.width,this.factor=monsters[t].factor}else this.width=120,this.factor=1,this.height=150;this.trueWidth=this.width*this.factor,this.trueHeight=this.height*this.factor,this.glitchMode=16==this.type&&{x:500*Math.random()-250,y:500*Math.random()-250,active:0},this.reload=0,this.path.init(this),this.hit=function($){return this.explode(),!1},this.explode=function(){score+=100,sound([3,,.3708,.5822,.3851,.0584,,-.0268,,,,-.0749,.7624,,,,,,1,,,,,.5]),GAME.addExplosion(this.x,this.y,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],2);for(var $=0;$<GAME.monsters.length;$++)if(GAME.monsters[$]==this){GAME.monsters.splice($,1);return}},this.update=function(){if(this.path.update(this),this.x<-50)return!1;if(GAME.player.armor){if(100>Math.hypot(this.x-(GAME.player.x+50),this.y-(GAME.player.y+30))||100>Math.hypot(this.x+this.trueWidth-(GAME.player.x+50),this.y+this.trueHeight-(GAME.player.y+30)))return sound([0,,.0967,.4264,.2902,.458,,-.3199,,,,.5693,.6278,,,,,,1,,,,,.5]),GAME.player.touch=10,GAME.player.armor-=20,this.explode(),!1}else if(this.x+this.trueWidth>GAME.player.x&&this.x<GAME.player.x+100&&this.y+this.trueHeight>GAME.player.y&&this.y<GAME.player.y+60)return GAME.player.life-=10,sound([3,,.2436,.5091,.252,.0334,,.2411,,,,,,,,,,,1,,,,,.5]),this.explode(),!1;if(this.glitchMode&&Math.random()>.95&&(this.glitchMode.active=1-this.glitchMode.active,this.glitchMode.active?(this.glitchMode={x:500*Math.random()-250,y:500*Math.random()-250,active:1},this.x+=this.glitchMode.x,this.y+=this.glitchMode.y):(this.x-=this.glitchMode.x,this.y-=this.glitchMode.y),this.x=Math.max(500,this.x),this.x=Math.min(1920,this.x),this.y=Math.max(0,this.y),this.y=Math.min(1e3,this.y)),ctx.drawImage(imgs[this.type],this.x,this.y),this.reload--,this.reload<1&&(this.reload=this.reloadingTime*Math.max(1,2/GAME.speed),GAME.player.life>0)){if(16==this.type){var $=bearing(GAME.player.x+50,GAME.player.y+30,this.x,this.y),_=0;for(i=$-Math.PI/2;i<$+Math.PI/2;i+=.3)setTimeout(this.multipleShot.bind(this,i),100*_),_++}else GAME.addLaser(this.x,this.y+this.trueHeight/2,this.weapon)}return!0},this.multipleShot=function($){sound([3,,.1379,.4076,.35,.1342,,-.3958,,,,,,,,,.535,-.2877,1,,,,,.5]),GAME.addLaser(this.x,this.y+this.trueHeight/2,this.weapon,$)}},BONUS=function($,_,t){this.x=$,this.y=_,this.type=t,this.time=bonusList[this.type].time?bonusList[this.type].time:0,this.round=0,this.update=function(){var t;if(this.x-=4,this.round+=.025,this.y+=2*Math.sin(this.round),this.x<0)return!1;if(t=GAME.player,this.x>t.x-30&&this.x<t.x+100&&this.y>t.y-30&&this.y<t.y+60){switch(this.type){case 2:sound([1,,.0854,,.78,.1,,.2148,,.1027,.2767,,,,,,,,1,,,,,.5]),GAME.player.armor=300;break;case 1:sound([1,,.01,,.6,.54,,.1799,.1999,.15,.02,-.0999,.52,,,.15,,,1,,,,,.5]),GAME.player.explodeAll={counter:50,x:t.x+50,y:t.y+30};break;case 3:sound([2,,.04,,.75,.43,.2,,.3999,.44,,-.7,.27,.7418,-.1559,.32,,-.02,.55,,,.1776,,.35]),GAME.player.weapon="triple",GAME.player.weaponTime=600}return!1}return $=this.x,_=this.y,(g=ctx.createLinearGradient($,_,$,_+20)).addColorStop(0,"#466BA9"),g.addColorStop(.25,"#6FB5FF"),g.addColorStop(.5,"#6FB5FF"),g.addColorStop(.75,"#6FB5FF"),g.addColorStop(1,"#4772B8"),ctx.fillStyle=g,ctx.lineWidth=1,ctx.strokeStyle="rgba(37,60,99,0.5)",ctx.beginPath(),ctx.moveTo($+6,_),ctx.lineTo($+24,_),ctx.arcTo($+30,_,$+30,_+6,6),ctx.lineTo($+30,_+24),ctx.arcTo($+30,_+30,$+24,_+30,6),ctx.lineTo($+6,_+30),ctx.arcTo($,_+30,$,_+24,6),ctx.lineTo($,_+6),ctx.arcTo($,_,$+6,_,6),ctx.stroke(),ctx.fill(),ctx.closePath(),drawText($+10,_+6,bonusList[this.type].letter,.75,"#000"),!0}},drawStar=function($,_,t,e){var o=(ctx=document.getElementById("bg").getContext("2d")).createRadialGradient($,_,0,$,_,t);o.addColorStop(0,"rgba("+e[0]+","+e[1]+","+e[2]+",0.7)"),o.addColorStop(.1,"rgba("+e[0]+","+e[1]+","+e[2]+",0.7)"),o.addColorStop(.11,"rgba("+e[0]+","+e[1]+","+e[2]+",0.3)"),o.addColorStop(1,"rgba(127,127,127,0)"),ctx.fillStyle=o,ctx.fillRect($-t,_-t,2*t,2*t)},drawStar2=function($,_,t){ctx.drawImage(grd[t],$,_)},GAME={speed:.5,sprites:[],monsters:[],weapons:[],bonus:[],explodeAll:null,level:1,showLevel:120,monsterCount:0,player:{x:180,y:440,armor:null,touch:0,life:300,weapon:"laser",weaponTime:0,died:!1},addExplosion:function($,_,t,e,o){this.sprites.push(new EXPLOSION($,_,t,e,o))},addBonus:function($,_,t){this.bonus.push(new BONUS($,_,t))},addMonster:function($,_,t,e){if(this.monsterCount>=50||this.showLevel)return!1;this.monsterCount++,this.monsters.push(new MONSTER($,_,t,e))},addLaser:function($,_,t,e){this.weapons.push(new window["WEAPON_"+t]($,_,e,t))}},frame=0,playeFireWait=0,fps=0,gameLoop=function(){if(auto){if(window.requestAnimationFrame(gameLoop),0==GAME.player.armor&&(sound([0,.09,.12,.3171,.61,.32,,-.12,,.23,.03,,,,,,,,1,,,,,.5]),GAME.player.armor=null),GAME.player.weaponTime-=.5,GAME.player.weaponTime<=0&&(GAME.player.weapon="laser",GAME.player.weaponTime=0),frame++%80==0){var $=Math.random();$=$>.66?7:$>.33?1:2,GAME.addMonster(1920,150+850*Math.random(),Math.floor(Math.random()*(monsters.length-2))+1,$)}if(50==GAME.monsterCount&&0==GAME.monsters.length&&(GAME.monsterCount=49,GAME.addMonster(1920,150+850*Math.random(),16,1),GAME.monsterCount=51),51==GAME.monsterCount&&0==GAME.monsters.length&&(GAME.level++,GAME.showLevel=120,GAME.monsterCount=0,GAME.speed*=1.1),frame%800==0){if(Math.random()>.5)for(Math.random()>.5?(y=600,$=3):(y=200,$=4),_=0;_<10;_++)GAME.addMonster(1920+100*_,y,1,$);else for(_=0;_<10;_++)GAME.addMonster(1920+200*_,200,2,5),GAME.addMonster(2020+200*_,600,2,6)}frame,frame%500==0&&GAME.addBonus(1900,800*Math.random(),Math.floor(Math.random()*(bonusList.length-1))+1),ctx.clearRect(0,0,1920,1080);for(var _=0;_<stars.length*quality;_++)ctx.drawImage(grd[_],stars[_].x,stars[_].y),stars[_].x-=.01*stars[_].size*(velocity.x+15),stars[_].x<0&&(stars[_].x=2e3);for(ctx.lineWidth=1,ctx.fillStyle="rgba(255,255,255,0.5)",ctx.fillRect(0,980,1920,100),ctx.fillStyle="rgba(255,255,255,0.8)",ctx.rect(820,1005,280,50),ctx.stroke(),drawText(50,1020,"LIFE",1),drawText(1130,1020,"WEAPON",1),ctx.fillStyle="rgba(255,255,255,0.8)",ctx.strokeStyle="#000",ctx.rect(150,1016,600,30),ctx.fillStyle="rgba(255 ,255,255,0.8)",ctx.strokeStyle="#000",ctx.rect(1260,1016,600,30),ctx.fill(),ctx.lineWidth=0,ctx.fillStyle="rgba(55,55,255,0.8)",ctx.fillRect(152,1018,Math.max(GAME.player.life,0),26),ctx.lineWidth=0,ctx.fillStyle="#E5A96E",ctx.fillRect(152+Math.max(GAME.player.life,0),1018,GAME.player.armor,26),ctx.lineWidth=0,ctx.fillStyle="rgba(255,55,55,0.8)",ctx.fillRect(1262,1018,GAME.player.weaponTime,26),ctx.stroke(),drawText(862,1014,("0000000"+score).substring(score.toString().length),1.5),velocity.x-=10*velocity.x*delta,velocity.z-=10*velocity.z*delta,velocity.y-=10*velocity.y*delta,moveForward&&(velocity.y+=100*delta),moveBackward&&(velocity.y-=100*delta),moveLeft&&(velocity.x-=100*delta),moveRight&&(velocity.x+=100*delta),GAME.player.y+=velocity.y,GAME.player.x+=velocity.x,GAME.player.life&&(GAME.player.x=Math.max(GAME.player.x,0)),playeFireWait--,spaceKey&&playeFireWait<1&&("laser"==GAME.player.weapon?GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"LASERPLAYER"):(GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"FIREBALLPLAYER"),GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"FIREBALLPLAYER",Math.PI/2-.25),GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"FIREBALLPLAYER",Math.PI/2+.25)),playeFireWait=10,sound([0,,.1541,.0294,.3834,.6142,.2,-.2723,,,,,,.1888,.0421,,,,1,,,,,.5])),_=0;_<GAME.sprites.length;_++)GAME.sprites[_].update()||GAME.sprites.splice(_--,1);for(_=0;_<GAME.monsters.length;_++)GAME.monsters[_].update()||GAME.monsters.splice(_--,1);for(_=0;_<GAME.weapons.length;_++)GAME.weapons[_].update()||GAME.weapons.splice(_--,1);for(_=0;_<GAME.bonus.length;_++)GAME.bonus[_].update()||GAME.bonus.splice(_--,1);if(GAME.player.armor){x=GAME.player.x+35,y=GAME.player.y+30,size=100+10*Math.sin(frame/10);var t=ctx.createRadialGradient(x,y,0,x,y,size);GAME.player.touch--,GAME.player.touch>=0?(t.addColorStop(0,"rgba(255,255,255,0)"),t.addColorStop(.8,"rgba(63,112,255,0.4)"),t.addColorStop(.81,"rgba(63, 112, 255,0.4)"),t.addColorStop(.91,"rgba(191,243,255,0.7)"),t.addColorStop(.95,"rgba(127,187,255,1)"),t.addColorStop(1,"rgba(127,187,255,0)")):(t.addColorStop(0,"rgba(0,0,0,0)"),t.addColorStop(.8,"rgba(0,0,0,0)"),t.addColorStop(.81,"rgba(255, 0, 63,0)"),t.addColorStop(.91,"rgba(255,243,191,0.7)"),t.addColorStop(.95,"rgba(255,187,127,1)"),t.addColorStop(1,"rgba(255,187,127,0)")),ctx.fillStyle=t,ctx.fillRect(x-size,y-size,2*size,2*size)}if(GAME.player.explodeAll){var e=GAME.player.explodeAll;x=e.x,y=e.y,size=e.counter;var t=ctx.createRadialGradient(x,y,0,x,y,size);for(e.counter*=1.1,t.addColorStop(0,"rgba(0,0,0,0)"),t.addColorStop(.8,"rgba(0,0,0,0)"),t.addColorStop(.81,"rgba(255, 0, 23,0)"),t.addColorStop(.91,"rgba(255,143,91,0.7)"),t.addColorStop(.95,"rgba(255,87,27,1)"),t.addColorStop(1,"rgba(255,87,27,0)"),ctx.fillStyle=t,ctx.fillRect(x-size,y-size,2*size,2*size),_=0;_<GAME.monsters.length;_++){var o=GAME.monsters[_];16!=o.type&&Math.hypot(o.x-(GAME.player.x+50),o.y-(GAME.player.y+30))<e.counter&&!o.hit(1)&&_--}e.counter>2e3&&(GAME.player.explodeAll=null)}GAME.player.life<=0&&(GAME.player.died||(GAME.addExplosion(GAME.player.x-10,GAME.player.y-10,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],4),GAME.addExplosion(GAME.player.x,GAME.player.y,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],2),GAME.addExplosion(GAME.player.x+10,GAME.player.y+10,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],4),GAME.player.died=!0,sound([3,,.3076,.6408,.97,.0108,,.2293,,,,,,,,,,,1,,,,,.51])),drawText(600,400,"GAME OVER",4,"#FFF"),GAME.player.x=-1e3,GAME.monsterCount=0),GAME.showLevel&&(drawText(700,400,"LEVEL "+GAME.level,4,"#FFF"),GAME.level>1&&drawText(860,560,"SPEED += 1",1,"#FFF"),GAME.showLevel--),ctx.drawImage(player,GAME.player.x,GAME.player.y,100,60-2*Math.abs(velocity.y))}},auto=!0,stars=[],grd=[],velocity={x:0,y:0,z:0},delta=.01,moveForward=moveBackward=moveLeft=moveRight=spaceKey=!1,player=!1,score=0,(font=[])[0]="111101101101111",font[1]="010110010010111",font[2]="111001111100111",font[3]="111001111001111",font[4]="101101111001001",font[5]="111100111001111",font[6]="111100111101111",font[7]="111001010010010",font[8]="111101111101111",font[9]="111101111001111",font.A="111101111101101",font.B="110101110101110",font.C="111100100100111",font.D="110101101101110",font.E="111100111100111",font.F="111100111100100",font.G="111100101101111",font.H="101101111101101",font.I="111010010010111",font.J="011001001101010",font.K="101101110101101",font.L="100100100100111",font.M="101111111101101",font.N="101111111111101",font.O="010101101101010",font.P="110101110100100",font.R="110101111110101",font.S="111100111001111",font.T="111010010010010",font.U="101101101101111",font.V="101101101101010",font.W="101101111111010",font.X="101101010101101",font.Y="101101010010010",font["-"]="000000111000000",font[":"]="000010000010000",font["."]="000000000000010",font[","]="000000000010100",font["?"]="010101001010010",font["+"]="000010111010000",font["="]="000111000111000",sounds=[],drawText=function($,_,t,e,o){ctx.fillStyle=o||"red",t=t.toString();for(var r=0;r<t.length;r++){var s=0;for(y=0;y<5;y++)for(x=0;x<3;x++)" "!=t[r]&&"1"==font[t[r]][s++]&&ctx.fillRect($+5*x*e,_+5*y*e,4*e,4*e);$+=20*e}},initAudio=function(){var $=new CPlayer;for($.init(song);1>$.generate(););var _=$.createWave();context.decodeAudioData(_.buffer,function($){musicBuffer=$,music.buffer=musicBuffer,music.connect(gainNode),music.start(0),music.loopEnd=56,music.loopStart=16,music.loop=!0;for(var _=1;_<monsters.length;_++)monsters[_].sprite&&drawSpriteToImg(_);(player=new Image).src="life.png";for(var _=0;_<500;_++){ctx.clearRect(0,0,1920,1080);var t=1920*Math.random(),e=1080*Math.random(),o=5+10*Math.random(),r=[2*(a=127+Math.floor(60*Math.random())),a,127+Math.floor(127*Math.random())];stars.push({x:t,y:e,size:o,color:r});var s=document.createElement("canvas");s.width=2*o,s.height=2*o;var n=s.getContext("2d"),l=n.createRadialGradient(o/2,o/2,0,o/2,o/2,o/2);l.addColorStop(0,"rgba("+r[0]+","+r[1]+","+r[2]+",0.7)"),l.addColorStop(.1,"rgba("+r[0]+","+r[1]+","+r[2]+",0.7)"),l.addColorStop(.11,"rgba("+r[0]+","+r[1]+","+r[2]+",0.3)"),l.addColorStop(1,"rgba(127,127,127,0)"),n.fillStyle=l,n.fillRect(0,0,2*o,2*o),grd[_]=new Image,grd[_].src=s.toDataURL("image/png")}gameLoop()})},init=function(){canvas=document.getElementById("bg"),ctx=document.getElementById("bg").getContext("2d"),drawText(640,400,"LOADING",4,"#FFF"),setTimeout(initAudio,1),imgs[16]=new Image,imgs[16].src="boss.png"};var keys=[];document.onkeydown=function($){switch(keys[$.keyCode]=!0,$.keyCode){case 38:moveBackward=!0;break;case 37:moveLeft=!0;break;case 40:moveForward=!0;break;case 39:moveRight=!0;break;case 32:spaceKey=!0}$.preventDefault()},document.onkeyup=function($){switch(keys[$.keyCode]=!1,$.keyCode){case 83:(snd=!snd)?playMusic():stopMusic();break;case 38:moveBackward=!1;break;case 37:moveLeft=!1;break;case 40:moveForward=!1;break;case 39:moveRight=!1;break;case 32:spaceKey=!1}};var song={songData:[{i:[1,130,128,0,1,25,128,9,0,0,7,5,52,0,0,0,0,0,0,2,255,0,0,32,47,3,17,2],p:[1,2,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[125,125,,125,125,,125,,125,125,,125,125,125,,,125,125,,125,125,,125,,125,125,,125,125,125,,,,,132,,,132,,132,,,132,,,,132,130,,,133,,,133,,133,,,133,,,,133,130,,,137,,,137,,137,,,137,,,,137,134,,,137,,,137,,137,,,137,,,,137,134],f:[]},{n:[123,123,,123,123,,123,,123,123,,123,123,123,,,120,120,,120,120,,120,,120,120,,120,120,120,,,,,130,,,130,,130,,,130,,,,130,125,,,127,,,127,,127,,,127,,,,127,127,,,135,,,135,,135,,,135,,,,135,130,,,132,,,132,,132,,,132,,,,132,132],f:[]}]},{i:[1,28,128,0,1,28,140,18,0,0,0,60,178,0,0,0,0,0,0,2,13,0,0,32,0,0,0,0],p:[,,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[113,,,,,,,,,,,,,,,,113,,,,,,,,,,,,,,,,120,,,,,,,,,,,,,,,,121,,,,,,,,,,,,,,,,125,,,,,,,,,,,,,,,,125],f:[]},{n:[111,,,,,,,,,,,,,,,,108,,,,,,,,,,,,,,,,118,,,,,,,,,,,,,,,,115,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,120],f:[]}]},{i:[1,124,128,0,1,125,140,18,0,0,0,29,52,0,0,0,0,0,0,2,13,0,0,32,0,0,0,0],p:[,,,,1,2,1,2,1,2,1,2,1,2],c:[{n:[113,,,,113,,,,113,,,,113,,,,113,,,,113,,,,113,,,,113,,,,,120,,120,,120,,120,,120,,120,,120,,120,,121,,121,,121,,121,,121,,121,,121,,121,,,125,,,,125,,,,125,,,,125,,,,125,,,,125,,,,125,,,,125],f:[]},{n:[111,,,,111,,,,111,,,,111,,,,108,,,,108,,,,108,,,,108,,,,,118,,118,,118,,118,,118,,118,,118,,118,,115,,115,,115,,115,,115,,115,,115,,115,,,123,,,,123,,,,123,,,,123,,,,120,,,,120,,,,120,,,,120],f:[]}]},{i:[0,160,128,1,0,160,128,0,1,210,4,7,41,0,0,0,60,4,1,2,33,0,0,32,61,5,0,6],p:[,,,,2,2,2,2,2,2,2,2,2,2],c:[{n:[120,,,,,,120,,120,,,,,,,,120,,,,,,120,,120,,,,,,,,120,,,,,,120,,120,,,,,,,,120,,,,,,120,,120],f:[]},{n:[120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,120,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,120],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,,1,1,2,2,2,2,2,2,2,2,2,2],c:[{n:[,,118,,,,118,,,,118,,,,118,,,,118,,,,118,,,,118,,,,118],f:[]},{n:[118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118],f:[]}]},{i:[0,160,128,1,0,160,128,0,1,210,4,7,41,0,0,0,60,4,1,2,255,0,0,32,61,0,0,0],p:[,,,2,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,120,,,,120,,,,120,,,,120,120,,,120,,,,120,,,,120,,,,120,120],f:[]},{n:[,,,,,,,,,,,,,,,,120,,,,120,,,,120,,120,,120,,120,120],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,40,0,0,0,69,3,1,1,0,167,0,32,77,6,25,6],p:[,,,1,6,7,2,3,2,3,4,5,4,5],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,149,151,152,154],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,53]},{n:[156,,,,,,,,,,,,149,151,152,154,157],f:[13,,,,,,,,,,,,13,,,,13,,,,,,,,,,,,,,,,130,,,,,,,,,,,,44,,,,130]},{n:[161,154,,156,159,,154,151,,151,152,,144,142,139,142,144,,,,147,,149,,151,,142,,149,151,152,154],f:[13,,,,,,,,,,,,,,,,13,,,,13,,,,,,,,13,,,,44,,,,,,,,,,,,,,,,81,,,,61,,,,,,,,44]},{n:[152,,149,,,149,,,149,,,,149,151,152,154,152,,149,,,149,,,149,,,,149,151,152,154],f:[]},{n:[151,,147,,,147,,,147,,,,149,151,152,154,151,,149,,,147,,,149,,,,151,151,152,154],f:[]},{n:[152,,156,,154,,151,,,,,152,156,,152,154,159,,161,,152,,152,,135,,137],f:[]},{n:[135,,,,135,,,,135,,,,135,,,,156,,,,159,,,,168,,,,171,,,,,142,,142,,142,,142,,142,,142,,142,,142,,,,,,,,,,,,,,,,,,,147,,,,147,,,,147,,,,147],f:[,,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,,,158,,,,,,,,,,,,,,,40]}]},{i:[0,0,128,0,0,0,128,0,0,125,0,52,109,0,0,0,0,0,0,1,193,171,0,29,39,3,88,3],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[125,,,,,,,,,,,,,,,,125],f:[]}]}],rowLen:5513,patternLen:32,endPattern:15},CPlayer=function(){var $,_,t,e,o,r=function($){return Math.sin(6.283184*$)},s=function($){return .003959503758*Math.pow(2,($-128)/12)},n=function($,_,t){var e,o,r,n,h,d,p,f=l[$.i[0]],u=$.i[1],m=$.i[3],w=l[$.i[4]],S=$.i[5],b=$.i[8],F=$.i[9],v=$.i[10]*$.i[10]*4,L=$.i[11]*$.i[11]*4,E=$.i[12]*$.i[12]*4,P=1/E,T=$.i[13],C=t*Math.pow(2,2-$.i[14]),I=new Int32Array(v+L+E),R=0,A=0;for(e=0,o=0;e<v+L+E;e++,o++)o>=0&&(T=T>>8|(255&T)<<4,o-=C,d=s(_+(15&T)+$.i[2]-128),p=s(_+(15&T)+$.i[6]-128)*(1+8e-4*$.i[7])),r=1,e<v?r=e/v:e>=v+L&&(r-=(e-v-L)*P),n=d,m&&(n*=r*r),R+=n,h=f(R)*u,n=p,b&&(n*=r*r),A+=n,h+=w(A)*S,F&&(h+=(2*Math.random()-1)*F),I[e]=80*h*r|0;return I},l=[r,function($){return $%1<.5?1:-1},function($){return 2*($%1)-1},function($){var _=$%1*4;return _<2?_-1:3-_}];this.init=function(r){$=r,_=r.endPattern-2,t=0,e=r.rowLen*r.patternLen*(_+1)*2,o=new Int32Array(e)},this.generate=function(){var s,h,d,p,f,u,m,w,S,b,F,v,L,E,P=new Int32Array(e),T=$.songData[t],C=$.rowLen,I=$.patternLen,R=0,A=0,k=!1,B=[];for(d=0;d<=_;++d)for(p=0,m=T.p[d];p<I;++p){var M=m?T.c[m-1].f[p]:0;M&&(T.i[M-1]=T.c[m-1].f[p+I]||0,M<15&&(B=[]));var D=l[T.i[15]],W=T.i[16]/512,N=Math.pow(2,T.i[17]-9)/C,H=T.i[18],G=T.i[19],z=135.82764118168*T.i[20]/44100,O=1-T.i[21]/255,U=1e-5*T.i[22],Y=T.i[23]/32,q=T.i[24]/512,V=6.283184*Math.pow(2,T.i[25]-9)/C,K=T.i[26]/255,X=T.i[27]*C;for(f=0,F=(d*I+p)*C;f<4;++f)if(u=m?T.c[m-1].n[p+f*I]:0){B[u]||(B[u]=n(T,u,C));var J=B[u];for(h=0,s=2*F;h<J.length;h++,s+=2)P[s]+=J[h]}for(h=0;h<C;h++)(b=P[w=(F+h)*2])||k?(v=z,H&&(v*=D(N*w)*W+.5),R+=(v=1.5*Math.sin(v))*A,L=O*(b-A)-R,A+=v*L,b=3==G?A:1==G?L:R,U&&(b*=U,b=b<1?b>-1?r(.25*b):-1:1,b/=U),b*=Y,k=b*b>1e-5,E=b*(1-(S=Math.sin(V*w)*q+.5)),b*=S):E=0,w>=X&&(E+=P[w-X+1]*K,b+=P[w-X]*K),P[w]=0|E,P[w+1]=0|b,o[w]+=0|E,o[w+1]+=0|b}return++t/8},this.createWave=function(){var $=2*e-8,_=$-36,t=new Uint8Array(44+2*e);t.set([82,73,70,70,255&$,$>>8&255,$>>16&255,$>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&_,_>>8&255,_>>16&255,_>>24&255]);for(var r=0,s=44;r<e;++r){var n=o[r];n=n<-32767?-32767:n>32767?32767:n,t[s++]=255&n,t[s++]=n>>8&255}return t},this.getData=function($,_){for(var t=2*Math.floor(44100*$),e=Array(_),r=0;r<2*_;r+=1){var s=t+r;e[r]=$>0&&s<o.length?o[s]/32768:0}return e}};musicBuffer=!1;var context=new AudioContext,gainNode=context.createGain(),music=context.createBufferSource();gainNode.connect(context.destination);var quality=1,snd=!0;function playMusic(){gainNode.gain.value=1,snd=!0}function stopMusic(){gainNode.gain.value=0,snd=!1}sound=function($){snd&&playSound($)};
		</script>
	</head>
	<body onload="init()">
		<canvas id="bg" width="1920" height="1080"></canvas>
		<div style="position:absolute;top:0; left:0; background-color:#FFF" id="FPS"></div>
	</body>
</html>
